Min-25 筛本质上是对埃氏筛进行了扩展，用于求解积性函数的前缀和，要求其在质数与质数的次幂处的取值可以被快速计算。


\subsubsection*{第一步}

求 $g(n) = \sum_{p\le n} f(p)$。


设 $g(n, j)$ = $\sum_{i=1}^n [i\text{是质数}\vee i\text{ 的最小质因子}>p_j]f(i)$。


因此，能得到递推式：
$$
g(n,j) = g(n, j-1) - f(p_j)\left(g\left(\left \lfloor  \dfrac{n}{p_j}\right \rfloor, j-1 \right) - g\left(p_{j-1}, j-1\right)\right)
$$

\subsubsection*{第二步}
\subparagraph*{做法一}


设 $S(n, j)$ = $\sum_{i=2}^n [i\text{ 的最小质因子}>p_j]f(i)$。

最后答案就是 $S(n,0) + f(1)$。

把 $S(n,j)$ 分成质数部分和合数部分进行计算。

$$
\begin{aligned}
S(n,j) &= g(n) - g(p_j) \\
 &+\sum_{j<k,p_k\le\sqrt n,p_k^{e+1}\le n }\left( f(p_k^e) S\left ( \left \lfloor \dfrac{n}{p_k^e} \right \rfloor,k  \right )  f(p_k^{e+1})\right)
\end{aligned}
$$


然后暴力递归计算。


\subparagraph*{做法二}


设 $S(n, j)$ = $\sum_{i=2}^n [i\text{是质数}\vee i\text{ 的最小质因子}>p_j]f(i)$。


写出递推式：
$$
\begin{aligned}
S(n,j) &= S(n,j+1)\\
&+\sum_{p_{j+1}\le\sqrt n,p_{j+1}^{e+1}\le n}f(p_{j+1}^e)\left(S\left ( \left \lfloor \dfrac{n}{p_{j+1}^e} \right \rfloor ,j+1 \right ) -g(p_{j+1})\right)\\
&+ f(p_{j+1}^{e+1})
\end{aligned}
$$

和第一步中一样，滚动数组 dp 即可，\textbf{边界条件} $S(x,\cdot)=g(x)$。


\textbf{注意到做法二可以求出所有 $S(\left\lfloor\frac n x\right\rfloor)$，这是做法一无法完成的。}



以下是洛谷 P5325 求积性函数 $f(p^k)=p^k(p^k-1),p\in\mathbb P$ 的前缀和的代码：
\inputminted{cpp}{src/number theory/min25.cpp}